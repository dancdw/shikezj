var context="http://oauth.d.cn/auth";function DJPASS(){var b=function(j){var i=document.cookie.match(new RegExp("(^| )"+j+"=([^;]*)(;|$)"));if(i!=null){return decodeURI(unescape(i[2],"utf-8"))}return null};var f=function(i){i&&(window.location.href=i.split("#")[0])};function e(){var i=b("djtk");var j=b("DJ_MEMBER_INFO");return !!(i&&j)}function h(k){if(e()){if(typeof k=="function"){k()}}else{var i=b("AMBI");var j=b("_AES");if(!!(i&&j)){jQuery.ajax({url:"http://d.cn/connect/dj/checkLogin",data:{"a":i,"s":j},dataType:"jsonp",success:function(l){if(l.result=="ok"){k()}},error:function(){console.log("请检查网络！")}})}}}function d(i){jQuery.ajax({async:true,url:"http://d.cn/connect/dj/setcookieforlogin",type:"GET",dataType:"jsonp",jsonp:"jsoncallback",data:i.data,timeout:15000,success:function(j){if(typeof i.callback=="function"){i.callback()}i.toUrl&&f(i.toUrl)},error:function(j){toUrl&&f(toUrl)}})}function a(i){if(!i||i.length==0){i=window.location.href}jQuery.ajax({async:true,url:context+"/logout.html",type:"GET",dataType:"jsonp",jsonp:"jsonCallback",data:{"to":encodeURI(i),"display":"json"},timeout:15000,success:function(j){c();var k={"type":"remove"};d({data:k,toUrl:i})},error:function(j){}})}function c(){try{if(typeof QC!="undefined"){QC.Login.signOut()}if(typeof WB2!="undefined"){if(WB2.checkLogin()){WB2.logout(function(){})}}}catch(i){}}function g(k){var i=null;var j=b("djtk");if(null==j||""==j){return i}jQuery.ajax({url:context+"/api/getUserBydjtk.html",data:{"djtk":j},dataType:"jsonp",success:function(l){if(l.result=="ok"){i=l}else{console.log(l.msg)}if(typeof k=="function"){k(i)}},error:function(){console.log("请检查网络！")}})}return{isLogin:e,isAutoLogin:h,logout:a,getMemberInfo:g}};