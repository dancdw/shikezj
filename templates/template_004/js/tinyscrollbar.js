(function(e){function t(t,n){function r(e){return d.ratio>=1||(S.now=Math.min(m[n.axis]-g[n.axis],Math.max(0,S.start+((y?e.pageX:e.pageY)-x.start))),E=S.now*v.ratio,d.obj.css(b,-E),g.obj.css(b,S.now)),!1}function i(t){return e(document).unbind("mousemove",r),e(document).unbind("mouseup",i),g.obj.unbind("mouseup",i),document.ontouchmove=g.obj[0].ontouchend=document.ontouchend=null,!1}function s(t){if(!(d.ratio>=1)){var t=t||window.event,r=t.wheelDelta?t.wheelDelta/120:-t.detail/3;E-=r*n.wheel,E=Math.min(d[n.axis]-p[n.axis],Math.max(0,E)),g.obj.css(b,E/v.ratio),d.obj.css(b,-E),t=e.event.fix(t),t.preventDefault()}}function o(t){x.start=y?t.pageX:t.pageY;var n=parseInt(g.obj.css(b));return S.start=n=="auto"?0:n,e(document).bind("mousemove",r),document.ontouchmove=function(t){e(document).unbind("mousemove"),r(t.touches[0])},e(document).bind("mouseup",i),g.obj.bind("mouseup",i),g.obj[0].ontouchend=document.ontouchend=function(t){e(document).unbind("mouseup"),g.obj.unbind("mouseup"),i(t.touches[0])},!1}function u(){g.obj.bind("mousedown",o),g.obj[0].ontouchstart=function(e){return e.preventDefault(),g.obj.unbind("mousedown"),o(e.touches[0]),!1},m.obj.bind("mouseup",r),n.scroll&&this.addEventListener?(h[0].addEventListener("DOMMouseScroll",s,!1),h[0].addEventListener("mousewheel",s,!1)):n.scroll&&(h[0].onmousewheel=s)}function f(){g.obj.css(b,E/v.ratio),d.obj.css(b,-E),x.start=g.obj.offset()[b];var e=w.toLowerCase();v.obj.css(e,m[n.axis]),m.obj.css(e,m[n.axis]),g.obj.css(e,g[n.axis])}function l(){return c.update(),u(),c}var c=this,h=t,p={obj:e(".viewport",t)},d={obj:e(".overview",t)},v={obj:e(".scrollbar",t)},m={obj:e(".track",v.obj)},g={obj:e(".thumb",v.obj)},y=n.axis=="x",b=y?"left":"top",w=y?"Width":"Height",E,S={start:0,now:0},x={};return this.update=function(e){p[n.axis]=p.obj[0]["offset"+w],d[n.axis]=d.obj[0]["scroll"+w],d.ratio=p[n.axis]/d[n.axis],v.obj.toggleClass("disable",d.ratio>=1),m[n.axis]=n.size=="auto"?p[n.axis]:n.size,g[n.axis]=Math.min(m[n.axis],Math.max(0,n.sizethumb=="auto"?m[n.axis]*d.ratio:n.sizethumb)),v.ratio=n.sizethumb=="auto"?d[n.axis]/m[n.axis]:(d[n.axis]-p[n.axis])/(m[n.axis]-g[n.axis]),E=e=="relative"&&d.ratio<=1?Math.min(d[n.axis]-p[n.axis],Math.max(0,E)):0,E=e=="bottom"&&d.ratio<=1?d[n.axis]-p[n.axis]:isNaN(parseInt(e))?E:parseInt(e),f()},l()}e.tiny=e.tiny||{},e.tiny.scrollbar={options:{axis:"y",wheel:40,scroll:!0,size:"auto",sizethumb:"auto"}},e.fn.tinyscrollbar=function(n){var n=e.extend({},e.tiny.scrollbar.options,n);return this.each(function(){e(this).data("tsb",new t(e(this),n))}),this},e.fn.tinyscrollbar_update=function(t){return e(this).data("tsb").update(t)}})(jQuery)